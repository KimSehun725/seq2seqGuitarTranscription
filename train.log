[2023-05-16 17:01:35,341][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:01:35,348][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:01:35,351][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 36, in wrap
    extras(cfg)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 91, in extras
    rich_utils.print_config_tree(cfg, resolve=True, save_to_file=True)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/lightning_utilities/core/rank_zero.py", line 27, in wrapped_fn
    return fn(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/rich_utils.py", line 63, in print_config_tree
    branch_content = OmegaConf.to_yaml(config_group, resolve=resolve)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/omegaconf.py", line 760, in to_yaml
    container = OmegaConf.to_container(cfg, resolve=resolve, enum_to_str=True)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/omegaconf.py", line 573, in to_container
    return BaseContainer._to_content(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/basecontainer.py", line 292, in _to_content
    value = get_node_value(key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/basecontainer.py", line 244, in get_node_value
    conf._format_and_raise(key=key, value=None, cause=e)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 231, in _format_and_raise
    format_and_raise(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/basecontainer.py", line 242, in get_node_value
    node = node._dereference_node()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 246, in _dereference_node
    node = self._dereference_node_impl(throw_on_resolution_failure=True)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 277, in _dereference_node_impl
    return parent._resolve_interpolation_from_parse_tree(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 584, in _resolve_interpolation_from_parse_tree
    resolved = self.resolve_parse_tree(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 764, in resolve_parse_tree
    return visitor.visit(parse_tree)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar/gen/OmegaConfGrammarParser.py", line 206, in accept
    return visitor.visitConfigValue(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar_visitor.py", line 101, in visitConfigValue
    return self.visit(ctx.getChild(0))
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar/gen/OmegaConfGrammarParser.py", line 342, in accept
    return visitor.visitText(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar_visitor.py", line 298, in visitText
    return self.visitInterpolation(c)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar_visitor.py", line 125, in visitInterpolation
    return self.visit(ctx.getChild(0))
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar/gen/OmegaConfGrammarParser.py", line 921, in accept
    return visitor.visitInterpolationNode(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar_visitor.py", line 158, in visitInterpolationNode
    return self.node_interpolation_callback(inter_key, self.memo)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 745, in node_interpolation_callback
    return self._resolve_node_interpolation(inter_key=inter_key, memo=memo)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 676, in _resolve_node_interpolation
    raise InterpolationKeyError(f"Interpolation key '{inter_key}' not found")
omegaconf.errors.InterpolationKeyError: Interpolation key 'local_env.n_workers' not found
    full_key: datamodule.n_workers
    object_type=dict
[2023-05-16 17:01:35,356][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-01-35
[2023-05-16 17:01:35,356][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:02:40,370][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:02:40,376][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:02:40,379][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 36, in wrap
    extras(cfg)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 91, in extras
    rich_utils.print_config_tree(cfg, resolve=True, save_to_file=True)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/lightning_utilities/core/rank_zero.py", line 27, in wrapped_fn
    return fn(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/rich_utils.py", line 63, in print_config_tree
    branch_content = OmegaConf.to_yaml(config_group, resolve=resolve)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/omegaconf.py", line 760, in to_yaml
    container = OmegaConf.to_container(cfg, resolve=resolve, enum_to_str=True)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/omegaconf.py", line 573, in to_container
    return BaseContainer._to_content(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/basecontainer.py", line 292, in _to_content
    value = get_node_value(key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/basecontainer.py", line 244, in get_node_value
    conf._format_and_raise(key=key, value=None, cause=e)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 231, in _format_and_raise
    format_and_raise(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/basecontainer.py", line 242, in get_node_value
    node = node._dereference_node()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 246, in _dereference_node
    node = self._dereference_node_impl(throw_on_resolution_failure=True)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 277, in _dereference_node_impl
    return parent._resolve_interpolation_from_parse_tree(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 584, in _resolve_interpolation_from_parse_tree
    resolved = self.resolve_parse_tree(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 764, in resolve_parse_tree
    return visitor.visit(parse_tree)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar/gen/OmegaConfGrammarParser.py", line 206, in accept
    return visitor.visitConfigValue(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar_visitor.py", line 101, in visitConfigValue
    return self.visit(ctx.getChild(0))
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar/gen/OmegaConfGrammarParser.py", line 342, in accept
    return visitor.visitText(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar_visitor.py", line 298, in visitText
    return self.visitInterpolation(c)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar_visitor.py", line 125, in visitInterpolation
    return self.visit(ctx.getChild(0))
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/antlr4/tree/Tree.py", line 34, in visit
    return tree.accept(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar/gen/OmegaConfGrammarParser.py", line 921, in accept
    return visitor.visitInterpolationNode(self)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/grammar_visitor.py", line 158, in visitInterpolationNode
    return self.node_interpolation_callback(inter_key, self.memo)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 745, in node_interpolation_callback
    return self._resolve_node_interpolation(inter_key=inter_key, memo=memo)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/omegaconf/base.py", line 676, in _resolve_node_interpolation
    raise InterpolationKeyError(f"Interpolation key '{inter_key}' not found")
omegaconf.errors.InterpolationKeyError: Interpolation key 'local_env.n_workers' not found
    full_key: datamodule.n_workers
    object_type=dict
[2023-05-16 17:02:40,383][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-02-40
[2023-05-16 17:02:40,383][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:15:14,264][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:15:14,269][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:15:14,357][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:15:14,371][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:15:17,837][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'n_workers'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 45, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.datamodules.classic_guitar.ClassicGuitarDataModule':
TypeError("__init__() got an unexpected keyword argument 'n_workers'")
full_key: datamodule
[2023-05-16 17:15:17,840][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-15-14
[2023-05-16 17:15:17,840][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:17:05,111][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:17:05,123][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:17:05,217][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:17:05,229][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:17:07,047][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'mode'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 45, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.datamodules.classic_guitar.ClassicGuitarDataModule':
TypeError("__init__() got an unexpected keyword argument 'mode'")
full_key: datamodule
[2023-05-16 17:17:07,051][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-17-04
[2023-05-16 17:17:07,051][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:18:19,801][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:18:19,807][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:18:19,896][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:18:19,904][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:18:21,818][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:18:21,831][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models' has no attribute 'hybrid_ctc_lit_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 844, in exec_module
  File "<frozen importlib._bootstrap_external>", line 981, in get_code
  File "<frozen importlib._bootstrap_external>", line 911, in source_to_code
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/hybrid_ctc_lit_module.py", line 231
    self.plot_output(gt_pianoroll, ctc_preds_pianoroll, tr_preds_pianoroll, track_name_list[i]):
                                                                                               ^
SyntaxError: invalid syntax

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.hybrid_ctc_lit_module.HybridCTCLitModule':
SyntaxError('invalid syntax', ('/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/hybrid_ctc_lit_module.py', 231, 105, '            self.plot_output(gt_pianoroll, ctc_preds_pianoroll, tr_preds_pianoroll, track_name_list[i]):\n'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    model: LightningModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.hybrid_ctc_lit_module.HybridCTCLitModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 17:18:21,834][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-18-19
[2023-05-16 17:18:21,834][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:20:37,852][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:20:37,858][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:20:37,951][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:20:37,959][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:20:39,878][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:20:39,888][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models' has no attribute 'hybrid_ctc_lit_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 844, in exec_module
  File "<frozen importlib._bootstrap_external>", line 981, in get_code
  File "<frozen importlib._bootstrap_external>", line 911, in source_to_code
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/hybrid_ctc_lit_module.py", line 231
    self.plot_output(gt_pianoroll, ctc_preds_pianoroll, tr_preds_pianoroll, track_name_list[i]):
                                                                                               ^
SyntaxError: invalid syntax

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.hybrid_ctc_lit_module.HybridCTCLitModule':
SyntaxError('invalid syntax', ('/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/hybrid_ctc_lit_module.py', 231, 105, '            self.plot_output(gt_pianoroll, ctc_preds_pianoroll, tr_preds_pianoroll, track_name_list[i]):\n'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    model: LightningModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.hybrid_ctc_lit_module.HybridCTCLitModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 17:20:39,890][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-20-37
[2023-05-16 17:20:39,891][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:24:34,184][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:24:34,189][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:24:34,276][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:24:34,285][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:24:35,447][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:24:35,589][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models.network' has no attribute 'hybrid_ctc_net'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/network/hybrid_ctc_net.py", line 5, in <module>
    from espnet2.asr.encoder.conformer_encoder import ConformerEncoder
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/espnet2/asr/encoder/conformer_encoder.py", line 10, in <module>
    from typeguard import check_argument_types
ImportError: cannot import name 'check_argument_types' from 'typeguard' (/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/typeguard/__init__.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.network.hybrid_ctc_net.HybridCTCNet':
ImportError("cannot import name 'check_argument_types' from 'typeguard' (/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/typeguard/__init__.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    model: LightningModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.network.hybrid_ctc_net.HybridCTCNet', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.hybrid_ctc_net
[2023-05-16 17:24:35,592][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-24-34
[2023-05-16 17:24:35,592][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:36:57,107][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:36:57,114][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:36:57,227][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:36:57,236][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:37:00,747][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:37:00,915][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models.network' has no attribute 'hybrid_ctc_net'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/network/hybrid_ctc_net.py", line 172, in <module>
    class HybridCTCNet(nn.Module):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/network/hybrid_ctc_net.py", line 189, in HybridCTCNet
    transformer_decoder: TransformerDecoder,
NameError: name 'TransformerDecoder' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.network.hybrid_ctc_net.HybridCTCNet':
NameError("name 'TransformerDecoder' is not defined")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    model: LightningModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.network.hybrid_ctc_net.HybridCTCNet', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.hybrid_ctc_net
[2023-05-16 17:37:00,919][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-36-56
[2023-05-16 17:37:00,919][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:45:19,099][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:45:19,106][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:45:19,204][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:45:19,212][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:45:21,017][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:45:21,878][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models.network.hybrid_ctc_net.TransformerDecoder'; 'src.models.network.hybrid_ctc_net' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.network.hybrid_ctc_net.TransformerDecoder':
ModuleNotFoundError("No module named 'src.models.network.hybrid_ctc_net.TransformerDecoder'; 'src.models.network.hybrid_ctc_net' is not a package")
Are you sure that 'TransformerDecoder' is importable from module 'src.models.network.hybrid_ctc_net'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    model: LightningModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.network.hybrid_ctc_net.TransformerDecoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.hybrid_ctc_net.transformer_decoder
[2023-05-16 17:45:21,881][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-45-18
[2023-05-16 17:45:21,881][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:47:00,476][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:47:00,481][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:47:00,570][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:47:00,578][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:47:02,251][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:47:02,520][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models.network.hybrid_ctc_net.TransformerDecoder'; 'src.models.network.hybrid_ctc_net' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.network.hybrid_ctc_net.TransformerDecoder':
ModuleNotFoundError("No module named 'src.models.network.hybrid_ctc_net.TransformerDecoder'; 'src.models.network.hybrid_ctc_net' is not a package")
Are you sure that 'TransformerDecoder' is importable from module 'src.models.network.hybrid_ctc_net'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 53, in train
    model: LightningModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.network.hybrid_ctc_net.TransformerDecoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.hybrid_ctc_net.transformer_decoder
[2023-05-16 17:47:02,523][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-47-00
[2023-05-16 17:47:02,523][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:51:12,610][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:51:12,616][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:51:12,726][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:51:12,736][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:51:14,479][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:51:14,751][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models.network.hybrid_ctc_net.TransformerDecoder'; 'src.models.network.hybrid_ctc_net' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.network.hybrid_ctc_net.TransformerDecoder':
ModuleNotFoundError("No module named 'src.models.network.hybrid_ctc_net.TransformerDecoder'; 'src.models.network.hybrid_ctc_net' is not a package")
Are you sure that 'TransformerDecoder' is importable from module 'src.models.network.hybrid_ctc_net'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 52, in train
    model: LightningModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.network.hybrid_ctc_net.TransformerDecoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.hybrid_ctc_net.transformer_decoder
[2023-05-16 17:51:14,754][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-51-12
[2023-05-16 17:51:14,754][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:52:00,113][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:52:00,122][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:52:00,211][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:52:00,219][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:52:01,476][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:52:01,642][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 970, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models.network.hybrid_ctc_net.TransformerDecoder'; 'src.models.network.hybrid_ctc_net' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.network.hybrid_ctc_net.TransformerDecoder':
ModuleNotFoundError("No module named 'src.models.network.hybrid_ctc_net.TransformerDecoder'; 'src.models.network.hybrid_ctc_net' is not a package")
Are you sure that 'TransformerDecoder' is importable from module 'src.models.network.hybrid_ctc_net'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 52, in train
    model: LightningModule = hydra.utils.instantiate(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.network.hybrid_ctc_net.TransformerDecoder', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model.hybrid_ctc_net.transformer_decoder
[2023-05-16 17:52:01,645][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-51-59
[2023-05-16 17:52:01,645][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:54:06,299][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:54:06,308][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:54:06,403][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:54:06,411][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:54:08,305][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:54:08,751][__main__][INFO] - Instantiating callbacks...
[2023-05-16 17:54:08,751][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 17:54:08,767][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-16 17:54:08,768][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 17:54:08,769][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 17:54:08,771][__main__][INFO] - Instantiating loggers...
[2023-05-16 17:54:08,771][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-16 17:54:08,859][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-16 17:54:09,053][__main__][INFO] - Logging hyperparameters!
[2023-05-16 17:54:12,724][__main__][INFO] - Starting training!
[2023-05-16 17:57:21,444][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
TypeError: setup() got an unexpected keyword argument 'stage'
[2023-05-16 17:57:21,456][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-54-06
[2023-05-16 17:57:21,456][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 17:57:21,457][src.utils.utils][INFO] - Closing wandb!
[2023-05-16 17:59:08,854][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:59:08,863][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:59:08,950][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 17:59:08,958][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 17:59:10,402][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 17:59:10,807][__main__][INFO] - Instantiating callbacks...
[2023-05-16 17:59:10,807][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 17:59:10,811][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-16 17:59:10,811][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 17:59:10,812][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 17:59:10,812][__main__][INFO] - Instantiating loggers...
[2023-05-16 17:59:10,812][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-16 17:59:10,886][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-16 17:59:11,044][__main__][INFO] - Logging hyperparameters!
[2023-05-16 17:59:13,574][__main__][INFO] - Starting training!
[2023-05-16 18:00:06,816][__main__][INFO] - Starting testing!
[2023-05-16 18:00:06,817][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 18:00:07,944][__main__][INFO] - Best ckpt path: None
[2023-05-16 18:00:07,948][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_17-59-08
[2023-05-16 18:00:07,950][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 18:00:07,951][src.utils.utils][INFO] - Closing wandb!
[2023-05-16 18:00:19,879][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 18:00:19,886][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 18:00:19,982][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 18:00:19,992][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 18:00:22,409][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 18:00:22,867][__main__][INFO] - Instantiating callbacks...
[2023-05-16 18:00:22,868][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 18:00:22,872][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-16 18:00:22,872][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 18:00:22,873][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 18:00:22,874][__main__][INFO] - Instantiating loggers...
[2023-05-16 18:00:22,874][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-16 18:00:22,958][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-16 18:00:23,190][__main__][INFO] - Logging hyperparameters!
[2023-05-16 18:00:26,034][__main__][INFO] - Starting training!
[2023-05-16 18:00:35,182][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1007, in _run_sanity_check
    call._call_callback_hooks(self, "on_sanity_check_end")
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 190, in _call_callback_hooks
    fn(trainer, trainer.lightning_module, *args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/callbacks/progress/rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-05-16 18:00:35,191][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_18-00-19
[2023-05-16 18:00:35,191][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 18:00:35,192][src.utils.utils][INFO] - Closing wandb!
[2023-05-16 18:01:48,592][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 18:01:48,599][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 18:01:48,695][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 18:01:48,705][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 18:01:50,658][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 18:01:51,059][__main__][INFO] - Instantiating callbacks...
[2023-05-16 18:01:51,059][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 18:01:51,063][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-16 18:01:51,064][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 18:01:51,064][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 18:01:51,065][__main__][INFO] - Instantiating loggers...
[2023-05-16 18:01:51,065][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-16 18:01:51,149][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-16 18:01:51,286][__main__][INFO] - Logging hyperparameters!
[2023-05-16 18:01:53,792][__main__][INFO] - Starting training!
[2023-05-16 18:08:38,282][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/loops/utilities.py", line 174, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
TypeError: validation_step() takes 2 positional arguments but 3 were given
[2023-05-16 18:08:38,301][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_18-01-48
[2023-05-16 18:08:38,301][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 18:08:38,302][src.utils.utils][INFO] - Closing wandb!
[2023-05-16 18:14:08,797][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 18:14:08,805][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 18:14:08,911][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 18:14:08,920][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 18:14:11,605][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 18:14:12,053][__main__][INFO] - Instantiating callbacks...
[2023-05-16 18:14:12,053][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 18:14:12,058][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-16 18:14:12,058][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 18:14:12,059][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 18:14:12,059][__main__][INFO] - Instantiating loggers...
[2023-05-16 18:14:12,059][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-16 18:14:12,152][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-16 18:14:12,405][__main__][INFO] - Logging hyperparameters!
[2023-05-16 18:14:15,473][__main__][INFO] - Starting training!
[2023-05-16 18:21:55,783][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/utils/utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "src/train.py", line 82, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/loops/utilities.py", line 174, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/hybrid_ctc_lit_module.py", line 125, in validation_step
    loss, ctc_preds_logprob, tr_preds_logits = self.model_step(batch)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/hybrid_ctc_lit_module.py", line 97, in model_step
    loss = self.loss_func(
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/src/models/loss/loss.py", line 63, in forward
    ce_loss = self.token_loss_func(token_preds_logits, padded_tokens_gt, token_lens_gt)
  File "/mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'CustomLoss' object has no attribute 'token_loss_func'
[2023-05-16 18:21:55,802][src.utils.utils][INFO] - Output dir: /mrnas03/homes/kim21-1000040/seq2seqGuitarTranscription/logs/train_hybrid_ctc/runs/2023-05-16_18-14-08
[2023-05-16 18:21:55,803][src.utils.utils][INFO] - Closing loggers...
[2023-05-16 18:21:55,803][src.utils.utils][INFO] - Closing wandb!
[2023-05-16 19:26:18,921][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 19:26:18,928][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 19:26:19,038][__main__][INFO] - Instantiating tokenizer <src.tokenizer.tokenizer.tokenizer_initializer>
[2023-05-16 19:26:19,047][__main__][INFO] - Instantiating datamodule <src.datamodules.classic_guitar.ClassicGuitarDataModule>
[2023-05-16 19:26:21,245][__main__][INFO] - Instantiating lightning module <src.models.hybrid_ctc_lit_module.HybridCTCLitModule>
[2023-05-16 19:26:21,771][__main__][INFO] - Instantiating callbacks...
[2023-05-16 19:26:21,772][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 19:26:21,776][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.LearningRateMonitor>
[2023-05-16 19:26:21,776][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 19:26:21,777][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 19:26:21,777][__main__][INFO] - Instantiating loggers...
[2023-05-16 19:26:21,778][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-16 19:26:21,865][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-05-16 19:26:22,060][__main__][INFO] - Logging hyperparameters!
[2023-05-16 19:26:24,796][__main__][INFO] - Starting training!
